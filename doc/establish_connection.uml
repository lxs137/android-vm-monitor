@startuml
Android <- AdbServer: CONNECT(version, maxdata, system-info)
note right
system-info = "<systemtype>:<serialno>:<banner>"
systemtype = "bootloader" | "device" | "host" 
serialno = uniqueID | null 
banner = otherProp
end note
Android -> AdbServer: AUTH(TOKEN(1), 0, RandomToken)

Android <- AdbServer: AUTH(SIGNATURE(2), 0, Sign)
note right: Sign = SignWithPrivateKey(RandomToken)

== Android端Sign验证成功 ==
Android -> AdbServer: CONNECT(version, maxdata, system-info)

== Android端Sign验证失败 ==
Android -> AdbServer: AUTH(TOKEN(1), 0, NewRandomToken)
Android <- AdbServer: AUTH(SIGNATURE(2), 0, NewSign)
note right: NewSign = SignWithDifferentPrivateKey(RandomToken)

== AdbServer所有PrivateKey验证失败 ==
Android <- AdbServer: AUTH(SAPUBLICKEY(3), 0, PublicKey)
Android -> AdbServer: CONNECT(version, maxdata, system-info)
@enduml